
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>CCI</title>
  <meta name="author" content="Takahiro Haruyama (@cci_forensics)">

  
  <meta name="description" content="I published the script automating remote malware triage with F-Response and openioc_scan. ">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://TakahiroHaruyama.github.io/blog">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="CCI" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46821758-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <!-- <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:TakahiroHaruyama.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav> -->
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:TakahiroHaruyama.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/03/remote-malware-triage-automation/">Remote Malware Triage Automation</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-07-03T11:06:53+09:00" pubdate data-updated="true">Jul 3<span>rd</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I published the script automating remote malware triage with F-Response and openioc_scan.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015/07/03/remote-malware-triage-automation/">Read on &rarr;</a>
    </footer>
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/24/dfrws-eu-slide-deck-and-generic-iocs/">DFRWS EU Slide Deck and Generic IOCs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-03-24T18:55:22+09:00" pubdate data-updated="true">Mar 24<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My talk pdf <em>&ldquo;Fast and Generic Malware Triage Using openioc_scan Volatility Plugin&rdquo;</em> is uploaded to <a href="http://www.slideshare.net/takahiroharuyama5/dfrwseu2015">SlideShare</a>. The code and IOC examples are located in <a href="https://github.com/TakahiroHaruyama/openioc_scan">GitHub</a>. Please let me know if you have any question and request.</p>
</div>
  
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/24/openioc-parameters-used-by-openioc-scan/">OpenIOC Parameters Used by Openioc_scan</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-24T18:09:24+09:00" pubdate data-updated="true">Oct 24<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>&ldquo;Parameters&rdquo; introduced in OpenIOC 1.1 allows embedding additional metadata about Indicators into the IOC (in more detail, see <a href="https://media.blackhat.com/us-13/Arsenal/us-13-Gibb-IOCWriter_11-Slides.pdf">Blackhat 2013 presentation</a> by William Gibb). I implemented functions displaying matched content details and scoring results of indicator matching.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/10/24/openioc-parameters-used-by-openioc-scan/">Read on &rarr;</a>
    </footer>
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/15/fast-malware-triage-using-openioc-scan-volatility-plugin/">Fast Malware Triage Using Openioc_scan Volatility Plugin</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-15T15:36:26+09:00" pubdate data-updated="true">Aug 15<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last year, I proposed &ldquo;volatile Indicators of Compromise (IOCs)&rdquo; based on RAM evidence only at <a href="http://digital-forensics.sans.org/summit-archives/DFIR_Summit/Volatile-IOCs-for-Fast-Incident-Response-Haruyama.pdf">SANS DFIR Summit</a>. We can detect malware using them faster than using disk-evidence-based IOCs. Besides, we can define indicators based on not only metadata (e.g., file path) but also malware function (e.g., code injection sign, imported functions and unpacked codes). The IOCs are described according to <a href="http://www.openioc.org/">OpenIOC</a> specification. <a href="http://www.mandiant.com/resources/download/ioc-editor/">IOC Editor</a> is used for defining IOCs and <a href="https://www.mandiant.com/resources/download/redline">Redline</a> is used for scannning IOCs.</p>

<p>Since then, I continued to make volatile IOCs and detect malware through the tools, but I&rsquo;ve got some frustrating problems about them. First, We can&rsquo;t automate IOC scanning for daily task because Redline is a GUI tool. Second, Redline is compliant with OpenIOC 1.0 but the spec doesn&rsquo;t support regular expression, case sensitiveness. In addition, &ldquo;AND&rdquo; combination of different items (e.g., ProcessItem and RegistryItem) does not work. Furthermore, <strong>Redline cannot scan unallocated objects (e.g., dead process, unloaded kernel drivers).</strong> So I decied to make a new tool for volatile IOCs.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/08/15/fast-malware-triage-using-openioc-scan-volatility-plugin/">Read on &rarr;</a>
    </footer>
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/21/memory-forensics-still-aborted/">Memory Forensics: Still Aborted</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-21T19:34:48+09:00" pubdate data-updated="true">Apr 21<span>st</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>2 years ago, I talked about the anti memory forensic method by modifying Windows kernel data structure on victim systems at <a href="http://www.blackhat.com/html/bh-eu-12/bh-eu-12-archives.html#haruyama">BlackHat Europe 2012</a>. The situation is still the same.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/04/21/memory-forensics-still-aborted/">Read on &rarr;</a>
    </footer>
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/27/id-slash-idapython-scripts-extracting-plugx-configs/">ID/IDAPython Scripts Extracting PlugX Configs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-27T00:00:00+09:00" pubdate data-updated="true">Mar 27<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I release Immunity Debugger and IDAPython scirpts dumping PlugX configs (and original PEs) then parsing them.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/03/27/id-slash-idapython-scripts-extracting-plugx-configs/">Read on &rarr;</a>
    </footer>
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/12/plugx-builder-slash-controller/">PlugX Builder/Controller (Type III, 0x840)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-12T19:44:27+09:00" pubdate data-updated="true">Mar 12<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently, I acquired a PlugX builder/controller. This seems to be the same as the one referred in <a href="http://image.ahnlab.com/global/upload/download/documents/1401223631603288.pdf">AhnLab&rsquo;s APT attacks analysis report</a>, judging from the GUI window. I tried to use it.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/03/12/plugx-builder-slash-controller/">Read on &rarr;</a>
    </footer>
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/07/64bit-big-size-ram-acquisition-problem/">64bit Big Sized RAM Image Acquisition Problem</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-07T22:15:39+09:00" pubdate data-updated="true">Jan 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>The Problem</h3>

<p>One day, I acquired a 16GB raw memory image on Windows7 x64 machine using MoonSols DumpIt for malware investigation. Then I tried to analyze it using Volatility Framework and Redline, but they returned no output like this:</p>

<p><img src="/images/post/vol_no_result.jpg" alt="vol_no_result" /></p>

<p>I guessed the acquired image was corrupted, so I took an image again, but the result was the same. I googled about the problem and found <a href="https://code.google.com/p/volatility/issues/detail?id=412">a similar issue</a>. According to the report, I tested several memory acquisition tools such as FTK Imager and Windows Memory Reader, but they didn&rsquo;t work.</p>

<p>I changed an image format from raw to crashdump. Then Volatility Framework could parse it and display the result. Strangely, Volatility also could analyze the raw image converted from the crashdump. Where does this difference come from?</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/01/07/64bit-big-size-ram-acquisition-problem/">Read on &rarr;</a>
    </footer>
  

</article>


    <article class="post">
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/05/some-old-stuffs/">Some Old Stuffs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-05T23:37:20+09:00" pubdate data-updated="true">Jan 5<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>IOCs for memory forensics</h3>

<p>Never forget to configure &ldquo;advanced parameters&rdquo; (check String and the length is 4)</p>

<ul>
<li><a href="/downloads/IOCs/23592725-e7cb-4391-9148-2ce25b1ed00d.ioc">ZeroAccess</a> for kernel/user-mode variants</li>
<li><a href="/downloads/IOCs/66132886-d06c-4612-b51d-031a1c9fbc30.ioc">Poison Ivy</a></li>
<li><a href="/downloads/IOCs/c229d84e-3981-4c71-a16f-aa6a17b22c75.ioc">Zeus 2.x variants</a> including Citadel</li>
<li><a href="/downloads/IOCs/42392189-6ef8-4869-bb2e-b457c3e05ba1.ioc">SpyEye 1.3.x</a></li>
</ul>


<h3>IDAPython script</h3>

<ul>
<li><a href="/downloads/scripts/Deobfuscating_SpyEye.zip">Deobfuscating_SpyEye</a> deobfuscate 4-byte hash values and strings</li>
<li><a href="/downloads/scripts/zeus_string_decoder.py">zeus_string_decoder</a> decode strings in ZeuS binary</li>
<li><a href="/downloads/scripts/fix_junk_pony.py">fix_junk_pony</a> modify PONY&rsquo;s junk code</li>
</ul>


<h3>Immunity Debugger script</h3>

<ul>
<li><a href="/downloads/scripts/immbone_nx.zip">immbone_nx</a> break on execute script on DEP environment (enable DEP and uncheck the option ignoring Memory access violation in the debugger settings)</li>
<li><a href="/downloads/scripts/immbone.zip">immbone</a> break on execute script on non-DEP environment (disable DEP and uncheck the option ignoring single-step break in the debugger settings)</li>
<li><a href="/downloads/scripts/blackmanta.py">blackmanta</a> slightly-changed version for Immunity Debugger v1.8</li>
</ul>


<h3>EnCase EnScript</h3>

<ul>
<li><a href="/downloads/scripts/CrashDumpAnalyzer_20110322.zip">CrashDumpAnalyzer</a> memory forensic EnScripts for MS crash dump</li>
<li><a href="/downloads/scripts/RawImageAnalyzer_20110322.zip">RawImageAnalyzer</a> memory forensic EnScripts for raw memory dump</li>
<li><a href="/downloads/scripts/Timeline_Report_v1.8.1_CCI_20120511.zip">Timeline_Report_v1.8.1_CCI</a> NTFS SI/FN timeline EnScript based on Geoff Black&rsquo;s timeline EnScript</li>
<li><a href="/downloads/scripts/PFDCforPE.EnScript">PFDCforPE</a> parse/filter/detect/carve PE files</li>
</ul>


<h3>Others</h3>

<ul>
<li><a href="/downloads/scripts/amf_7x86.c">amf_7x86</a> PoC driver for anti memory forensics on Windows7</li>
<li><a href="/downloads/scripts/amf_XPx86.c">amf_XPx86</a> PoC driver for anti memory forensics on WindowsXP</li>
</ul>


<!-- * [](downloads/scripts/) -->

</div>
  
  

</article>

<nav id="pagenavi">
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav>
    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Takahiro Haruyama (@cci_forensics) -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
